{% extends 'base.html.twig' %}

{% block title %}Home{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/main/index.css') }}">
{% endblock %}

{% block body %}
    <h2 class="center">Homepage</h2>
    <div class="bestProducts">
        <h3 class="center" id="productInput" data-status="open">Top 10 products</h3>
        {% for product in best_products %}
            <a href="{{ path('product_item', {'id': product.id}) }}" class="noneDecoration">
                <div class="product">
                    <div class="productHead">
                        <p class="productTitle">{{ product.title }}</p>
                    </div>
                    <div class="productBody">
                        <p class="productDescription">{{ product.description }}</p>
                        {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
                            {% set basket_items = app.user.basketItems %}
                            {% set coincidences = false %}

                            {% for basket_item in basket_items %}
                                {% if basket_item.basketProduct == product %}
                                    {% set coincidences = true %}
                                {% endif %}
                            {% endfor %}

                            {% if coincidences == false %}
                                <a class="noneDecoration" href="{{ path('add_product_to_basket', {'id': product.id}) }}">
                                        <span class="add_in_basket">
                                            <i class="fas fa-cart-plus"></i>
                                        </span>
                                </a>
                            {% else %}
                                <a class="noneDecoration" href="{{ path('basket') }}">
                                    <span class="add_in_basket">
                                        <i class="fas fa-shopping-cart"></i>
                                    </span>
                                </a>
                            {% endif %}
                        {% endif %}
                        <p class="productPrice">Price: {{ product.price }}</p>
                        <p class="productRating">Rating: {{ product.rating }}</p>
                    </div>
                </div>
            </a>
        {% endfor %}
    </div>
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('/js/main/index.js') }}"></script>
{% endblock %}
